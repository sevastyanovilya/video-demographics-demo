# Демографический анализ по истории просмотров

Этот репозиторий является переработанной версией проекта
«VSR», посвящённого предсказанию пола и возрастной категории
пользователей на основе их интересов.  В качестве пет‑проекта здесь
используется синтетический набор данных и обучаются простые
классификаторы, однако общая структура кода и интерфейсы позволяют
легко заменить их собственными моделями и данными.

## Особенности

* **Чистая архитектура.** Код разнесён по модулям (`src/`) и
  снабжён docstring‑комментариями.  Это облегчает понимание и
  расширение функциональности.
* **Модульное обучение.** В модуле `model_training.py` реализована
  генерация синтетического набора данных и обучение двух
  классификаторов (по полу и возрастной категории).  В реальном
  проекте вы можете заменить синтетику на свои размеченные данные.
* **Предсказания как сервис.** Класс `AgeGenderPredictor` в
  модуле `predictor.py` инкапсулирует загрузку моделей и
  преобразование текстов в векторное представление.  На его основе
  построен CLI‑скрипт `scripts/predict_cli.py`.

## Структура проекта

```text
VSR_pet_project/
├── data/                # папка для вспомогательных наборов данных
│   └── region.csv       # пример таблицы с регионами (здесь синтетика)
├── models/              # сохранённые модели (создаются после обучения)
│   ├── age_model.joblib
│   └── sex_model.joblib
├── scripts/
│   └── predict_cli.py   # CLI для получения предсказаний из терминала
├── src/
│   ├── __init__.py
│   ├── model_training.py# генерация и обучение на синтетике
│   └── predictor.py     # загрузка моделей и предсказания
├── requirements.txt     # зависимости проекта
└── README.md            # текущее описание
```

## Быстрый старт

Перед началом работы убедитесь, что у вас установлены Python 3.8+
и необходимые библиотеки.  Установите зависимости:

```bash
pip install -r requirements.txt
```

Затем обучите модели на синтетическом наборе данных (или
предоставьте свои данные, отредактировав функцию
`_generate_synthetic_dataset` в `src/model_training.py`):

```bash
python -m src.model_training
```

Команда создаст папку `models/` с файлами `age_model.joblib` и
`sex_model.joblib`.

Чтобы получить предсказания для списка заголовков, воспользуйтесь
CLI‑скриптом:

```bash
python scripts/predict_cli.py --input "football match highlights"

# или для файла со строками заголовков
python scripts/predict_cli.py --input path/to/titles.txt --output predictions.csv
```

Скрипт выведет таблицу с исходными заголовками и предсказанными
метками.  Метки для пола: `0` — мужской, `1` — женский; метки
для возраста: `0` — условно «молодая» аудитория, `1` — «взрослая»,
`2` — «старшая».  Эти значения обусловлены синтетическим набором
данных и могут не совпадать с реальными.

## Дальнейшее развитие

* **Собственные данные.** Замените генератор синтетики в
  `model_training.py` на чтение вашего датасета.  Убедитесь, что
  данные содержат текстовые описания (заголовки роликов) и
  соответствующие целевые признаки.
* **Иные модели.** Вместо наивного Байеса попробуйте другие
  алгоритмы (`LinearSVC`, `RandomForest`, `BERT` и т. д.).  Не
  забудьте сериализовать как модель, так и векторизатор.
* **API или веб‑сервис.** На базе класса `AgeGenderPredictor` легко
  написать FastAPI‑ или Flask‑приложение, принимающее тексты
  через HTTP и возвращающее предсказания.
